{# Template for interactive fiction reasoning with calculator tool #}
Current story state:
{{ observation }}

Available actions:
{% for choice in choices %}
{{ loop.index }}. {{ choice.text }}
{% endfor %}

{% if memory %}
Previous context:
{% if memory is string %}
{{ memory }}
{% else %}
{% for entry in memory %}
State: {{ entry.text | truncate(100) }}
Action: {{ entry.action }}

{% endfor %}
{% endif %}
{% endif %}

Analyze briefly:
1. Context: What's happening now?
2. Goal: What's the current objective?
3. Impact: What could each choice lead to?

You have access to a calculator tool. If you need to perform calculations to make a decision,
you can use the calculator by including "tool": "calculator" with a "query" in your response.

Your response should be in one of these JSON formats:

If you need to use the calculator:
```json
{
    "tool": "calculator",
    "query": "<math expression>"
}
```

If you're ready to make a decision:
```json
{
    "analysis": "<25 words on key situation elements>",
    "reasoning": "<25 words on why this choice>",
    "result": <action_number>
}
```
